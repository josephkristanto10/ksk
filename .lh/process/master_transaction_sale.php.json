{
    "sourceFile": "process/master_transaction_sale.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 83,
            "patches": [
                {
                    "date": 1633020159770,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1633020169781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -354,10 +354,9 @@\n     $dateend=date_create($myend);\r\n     $convertstart = date_format($datestart,\"Y-m-d\");\r\n     $convertend = date_format($dateend,\"Y-m-d\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_lend_to_relation`\r\n-    VALUES (NULL, 'TRX-020', '$mybranch', '$myasset', '$myrelation', '$myroom', '$convertstart', '$convertend', 'pending', 'waiting', '$mydate');\";\r\n+    $sql = \"INSERT INTO `transaction_sale` (`id`, `mydate`, `notransaction`, `idasset`, `approval`) VALUES (NULL, '2021-09-16', 'TRX-020202', '58', 'waiting')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633020345321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,15 +110,10 @@\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n                 \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n                 \"<label id ='branch\".$row['id'].\"'>\".$row['branch'].\"</label>\",\r\n                 \"<label id ='noasset\".$row['id'].\"'>\".$row['noasset'].\"</label>\",\r\n-                \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\",\r\n-                \"<label id ='company\".$row['id'].\"'>\".$row['company'].\"</label>\",\r\n-                \"<label id ='contactname\".$row['id'].\"'>\".$row['contactname'].\"</label>\",\r\n-                \"<label id ='room\".$row['id'].\"'>\".$row['room'].\"</label>\",\r\n-                \"<label id ='startdate\".$row['id'].\"'>\".$row['start_date'].\"</label>\",\r\n-                \"<label id ='duedate\".$row['id'].\"'>\".$row['due_date'].\"</label>\",\r\n-                \"<label id ='status\".$row['id'].\"'>\".$row['status'].\"</label>\"\r\n+                \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\"\r\n+            \r\n             ];\r\n         }\r\n     }\r\n     \r\n"
                },
                {
                    "date": 1633020443170,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,15 +24,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n-    inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n-    inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n-    inner join asset on asset.id = tltr.idasset\r\n-    inner join relation on relation.id  = tltr.relation\r\n-    inner join location_room lroom on lroom.id = tltr.room\r\n-    where lbranchsetup.idsistercompany = '$myses'\r\n+    \"select * from asset where idsistercompany = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n"
                },
                {
                    "date": 1633020508458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,9 +24,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"select * from asset where idsistercompany = '$myses'\r\n+    \"select * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n"
                },
                {
                    "date": 1633020543861,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,15 +30,9 @@\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n-        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n-        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n-        inner join asset on asset.id = tltr.idasset\r\n-        inner join relation on relation.id  = tltr.relation\r\n-        inner join location_room lroom on lroom.id = tltr.room\r\n-        where lbranchsetup.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"select * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n         inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n         inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n"
                },
                {
                    "date": 1633020550567,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,15 +24,15 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"select * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\r\n+    \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"select * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n         inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n         inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n"
                },
                {
                    "date": 1633020556916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,15 +32,9 @@\n     \r\n     if(empty($search)) {\r\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n-        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n-        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n-        inner join asset on asset.id = tltr.idasset\r\n-        inner join relation on relation.id  = tltr.relation\r\n-        inner join location_room lroom on lroom.id = tltr.room\r\n-        where lbranchsetup.idsistercompany = '$myses'\");\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n         inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n         inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n"
                },
                {
                    "date": 1633020564002,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,15 +34,9 @@\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\");\r\n     } else {\r\n-        $query_data = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n-        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n-        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n-        inner join asset on asset.id = tltr.idasset\r\n-        inner join relation on relation.id  = tltr.relation\r\n-        inner join location_room lroom on lroom.id = tltr.room\r\n-        where lbranchsetup.idsistercompany = '$myses' and (\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n             tltr.notransaction LIKE '%$search%' \r\n         OR lbranch.branch LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n"
                },
                {
                    "date": 1633020628502,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,10 +35,10 @@\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n-            tltr.notransaction LIKE '%$search%' \r\n-        OR lbranch.branch LIKE '%$search%'\r\n+            transaction_sale.notransaction LIKE '%$search%' \r\n+        OR transaction_sale.mydate LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n         OR relation.contactname LIKE '%$search%' \r\n         OR relation.company LIKE '%$search%' \r\n"
                },
                {
                    "date": 1633020638786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,10 +41,9 @@\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n         OR relation.contactname LIKE '%$search%' \r\n         OR relation.company LIKE '%$search%' \r\n-        OR tltr.approval LIKE '%$search%'\r\n-        OR tltr.status LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n+        OR tltr.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset,asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n         inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n         inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n"
                },
                {
                    "date": 1633020652836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,10 +39,8 @@\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n-        OR relation.contactname LIKE '%$search%' \r\n-        OR relation.company LIKE '%$search%' \r\n         OR tltr.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset,asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n         inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n"
                },
                {
                    "date": 1633020668987,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,23 +41,14 @@\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n         OR tltr.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset,asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n-        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n-        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n-        inner join asset on asset.id = tltr.idasset\r\n-        inner join relation on relation.id  = tltr.relation\r\n-        inner join location_room lroom on lroom.id = tltr.room\r\n-        where lbranchsetup.idsistercompany = '$myses' and (\r\n-            tltr.notransaction LIKE '%$search%' \r\n-        OR lbranch.branch LIKE '%$search%'\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n+            transaction_sale.notransaction LIKE '%$search%' \r\n+        OR transaction_sale.mydate LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n-        OR relation.contactname LIKE '%$search%' \r\n-        OR relation.company LIKE '%$search%' \r\n-        OR tltr.approval LIKE '%$search%'\r\n-        OR tltr.status LIKE '%$search%' )\");\r\n+        OR tltr.approval LIKE '%$search%' )\");\r\n     }\r\n     \r\n     $response['data'] = [];\r\n     \r\n"
                },
                {
                    "date": 1633020705354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -72,9 +72,8 @@\n                 \"<span class='pointer-element badge badge-success' id ='\".$row['id'].\"' data-id='\".$row['id'].\"'><i class='icon-plus3'></i></span>\",\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n                 \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n-                \"<label id ='branch\".$row['id'].\"'>\".$row['branch'].\"</label>\",\r\n                 \"<label id ='noasset\".$row['id'].\"'>\".$row['noasset'].\"</label>\",\r\n                 \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\"\r\n             \r\n             ];\r\n"
                },
                {
                    "date": 1633020789147,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,11 +7,10 @@\n {\r\n \r\n     $where_like = [\r\n         'notransaction',\r\n-        'branch',\r\n         'name',\r\n-        'contactname',\r\n+        'noasset',\r\n         'company',\r\n         'status'\r\n         \r\n     ];\r\n"
                },
                {
                    "date": 1633020822333,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,10 +9,9 @@\n     $where_like = [\r\n         'notransaction',\r\n         'name',\r\n         'noasset',\r\n-        'company',\r\n-        'status'\r\n+        'approval'\r\n         \r\n     ];\r\n     \r\n     $response = $_REQUEST;\r\n@@ -38,16 +37,16 @@\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n-        OR tltr.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n+        OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR asset.noasset LIKE '%$search%'\r\n         OR asset.name LIKE '%$search%'\r\n-        OR tltr.approval LIKE '%$search%' )\");\r\n+        OR transaction_sale.approval LIKE '%$search%' )\");\r\n     }\r\n     \r\n     $response['data'] = [];\r\n     \r\n"
                },
                {
                    "date": 1633020945325,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -297,15 +297,10 @@\n }\r\n \r\n else if($tipe == \"add\"){\r\n \r\n-    $myrelation = $_POST['myrelation'];\r\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n-    $mybranch = $_POST['mybranch'];\r\n-    $myroom = $_POST['myroom'];\r\n-    $mystart = $_POST['mystart'];\r\n-    $myend = $_POST['myend'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $datestart=date_create($mystart);\r\n     $dateend=date_create($myend);\r\n     $convertstart = date_format($datestart,\"Y-m-d\");\r\n"
                },
                {
                    "date": 1633020951194,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,12 +300,8 @@\n \r\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n-    $datestart=date_create($mystart);\r\n-    $dateend=date_create($myend);\r\n-    $convertstart = date_format($datestart,\"Y-m-d\");\r\n-    $convertend = date_format($dateend,\"Y-m-d\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` (`id`, `mydate`, `notransaction`, `idasset`, `approval`) VALUES (NULL, '2021-09-16', 'TRX-020202', '58', 'waiting')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n"
                },
                {
                    "date": 1633020958578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,9 +301,9 @@\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` (`id`, `mydate`, `notransaction`, `idasset`, `approval`) VALUES (NULL, '2021-09-16', 'TRX-020202', '58', 'waiting')\";\r\n+    $sql = \"INSERT INTO `transaction_sale`  VALUES (NULL, '2021-09-16', 'TRX-020202', '58', 'waiting')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633020966107,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,9 +301,9 @@\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale`  VALUES (NULL, '2021-09-16', 'TRX-020202', '58', 'waiting')\";\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '58', 'waiting')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633020971773,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,9 +301,9 @@\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '58', 'waiting')\";\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '58', 'pending')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633020985422,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,9 +301,9 @@\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '58', 'pending')\";\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '$myasset', 'pending')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633021079354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,8 @@\n                 $myapproval = \"<span style = 'color:#2aa602'><i class='mi-check-box'></i> &nbspAccepted </span>\";\r\n             }\r\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n-                \"<span class='pointer-element badge badge-success' id ='\".$row['id'].\"' data-id='\".$row['id'].\"'><i class='icon-plus3'></i></span>\",\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n                 \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n                 \"<label id ='noasset\".$row['id'].\"'>\".$row['noasset'].\"</label>\",\r\n"
                },
                {
                    "date": 1633490694338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -397,5 +397,102 @@\n         }\r\n     }\r\n     echo $mystring;\r\n }\r\n+else if($tipe == \"getdetailtransaction\")\r\n+{\r\n+    $idtransaction = $_POST['idtransaction'];\r\n+    $sql = \"select td.*, asset.name as assetname, asset.noasset  from transaction_dispose_log td inner join asset on asset.id = td.idasset where idtransaksi = '$idtransaction'\";\r\n+    $res = $conn->query($sql);\r\n+    $mystring = \"\";\r\n+    $mycountasset = 0;\r\n+    $mynumber = 1;\r\n+    if($res->num_rows>0)\r\n+    {\r\n+        $mycounter = 1;\r\n+        while($r = mysqli_fetch_array($res))\r\n+        {\r\n+            $mycountasset += 1;\r\n+            if($mycounter == 1)\r\n+            {\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div>\";\r\n+                $mycounter = 2;\r\n+            }\r\n+            else{\r\n+                $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div></div><br>\";\r\n+                $mycounter = 1;\r\n+            }\r\n+            $mynumber ++;\r\n+            \r\n+        }\r\n+        echo $mycountasset.\"||\".$mystring;\r\n+    }\r\n+    else\r\n+    {\r\n+        echo \"\";\r\n+    }\r\n+\r\n+}\r\n+else if($tipe == \"getasset\")\r\n+{\r\n+    $idcategory = $_POST['idcategory'];\r\n+    $sql =  \"select * from asset where idcategory = '$idcategory' and status_transaction = 'placed'\";\r\n+    $res = $conn->query($sql);\r\n+    $mystring = \"\";\r\n+    if($res->num_rows>0)\r\n+    {\r\n+        $mycounter = 1;\r\n+        while($r = mysqli_fetch_array($res))\r\n+        {\r\n+            if($mycounter == 1)\r\n+            {\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"' > \".$r['name'].\"</div>\";\r\n+                $mycounter = 2;\r\n+            }\r\n+            else{\r\n+                $mystring .= \"<div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"' > \".$r['name'].\"</div></div><br>\";\r\n+                $mycounter = 1;\r\n+            }\r\n+            \r\n+        }\r\n+        echo $mystring;\r\n+    }\r\n+    else\r\n+    {\r\n+        echo \"\";\r\n+    }\r\n+   \r\n+\r\n+}\r\n+else if($tipe == \"getsubgroup\")\r\n+{\r\n+    $idgroup = $_POST['idgroup'];\r\n+    $sql = \"SELECT ks.* from kategori_subgroup ks inner join kategori_asset ka on ka.id = ks.idkategoriaset\r\n+     where ka.id = '$idgroup'\";\r\n+    $res = $conn->query($sql);\r\n+    $mystring = \"\";\r\n+    if($res -> num_rows>0)\r\n+    {\r\n+        while($r = mysqli_fetch_array($res))\r\n+        {\r\n+            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['subgroup'].\"</option>\";\r\n+        }\r\n+    }\r\n+    echo $mystring;\r\n+}\r\n+else if($tipe == \"getcategory\")\r\n+{\r\n+    $idsubgroup = $_POST['idsubgroup'];\r\n+    $sql = \"SELECT kcs.* from kategori_categorysubgroup kcs \r\n+    where kcs.idsubgroup = '$idsubgroup'\";\r\n+    $res = $conn->query($sql);\r\n+    $mystring = \"\";\r\n+    if($res -> num_rows>0)\r\n+    {\r\n+        while($r = mysqli_fetch_array($res))\r\n+        {\r\n+            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['category'].\"</option>\";\r\n+        }\r\n+    }\r\n+    echo $mystring;\r\n+}\r\n ?>\r\n"
                },
                {
                    "date": 1633491478000,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -448,9 +448,9 @@\n                 $mystring .= \"<div class = 'row'><div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"' > \".$r['name'].\"</div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n-                $mystring .= \"<div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"' > \".$r['name'].\"</div></div><br>\";\r\n+                $mystring .= \"<div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"-\".$r['name'].\"' > \".$r['name'].\"</div></div><br>\";\r\n                 $mycounter = 1;\r\n             }\r\n             \r\n         }\r\n"
                },
                {
                    "date": 1633491489341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -444,9 +444,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             if($mycounter == 1)\r\n             {\r\n-                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"' > \".$r['name'].\"</div>\";\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"-\".$r['name'].\"' > \".$r['name'].\"</div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n                 $mystring .= \"<div class = 'col-md-6'><input class = 'mycheckbox' type = 'checkbox' value = '\".$r['id'].\"-\".$r['name'].\"' > \".$r['name'].\"</div></div><br>\";\r\n"
                },
                {
                    "date": 1633496035471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -295,9 +295,9 @@\n     echo $mystring;\r\n }\r\n \r\n else if($tipe == \"add\"){\r\n-\r\n+    $myselectedlist = $_POST['myselected'];\r\n     $mygroup = $_POST['mygroup'];\r\n     $myasset = $_POST['myasset'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n"
                },
                {
                    "date": 1633496063494,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,10 +296,9 @@\n }\r\n \r\n else if($tipe == \"add\"){\r\n     $myselectedlist = $_POST['myselected'];\r\n-    $mygroup = $_POST['mygroup'];\r\n-    $myasset = $_POST['myasset'];\r\n+    $myselectedlist = $_POST['myselected'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '$myasset', 'pending')\";\r\n     $res = $conn->query($sql);\r\n"
                },
                {
                    "date": 1633496069850,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,9 +296,9 @@\n }\r\n \r\n else if($tipe == \"add\"){\r\n     $myselectedlist = $_POST['myselected'];\r\n-    $myselectedlist = $_POST['myselected'];\r\n+    $myselectedprice = $_POST['myselected'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '$myasset', 'pending')\";\r\n     $res = $conn->query($sql);\r\n"
                },
                {
                    "date": 1633496076092,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -296,9 +296,9 @@\n }\r\n \r\n else if($tipe == \"add\"){\r\n     $myselectedlist = $_POST['myselected'];\r\n-    $myselectedprice = $_POST['myselected'];\r\n+    $myselectedprice = $_POST['myselectedprice'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '$myasset', 'pending')\";\r\n     $res = $conn->query($sql);\r\n"
                },
                {
                    "date": 1633496084174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,9 +299,9 @@\n     $myselectedlist = $_POST['myselected'];\r\n     $myselectedprice = $_POST['myselectedprice'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', '$myasset', 'pending')\";\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n"
                },
                {
                    "date": 1633496105933,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,8 +301,17 @@\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n+    $last_id = $conn->insert_id;\r\n+    for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n+    {\r\n+        $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n+        $resupdate =  $conn->query($sqlupdate);\r\n+        $sqls = \"INSERT INTO `transaction_dispose_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"')\";\r\n+        $ress = $conn->query($sqls);\r\n+      \r\n+    }\r\n     // echo $sql;\r\n     if(($conn -> affected_rows)>0)\r\n     {\r\n         echo \"sukses\";\r\n"
                },
                {
                    "date": 1633496111738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n         $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n         $resupdate =  $conn->query($sqlupdate);\r\n-        $sqls = \"INSERT INTO `transaction_dispose_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"')\";\r\n+        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"')\";\r\n         $ress = $conn->query($sqls);\r\n       \r\n     }\r\n     // echo $sql;\r\n"
                },
                {
                    "date": 1633496125022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n         $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n         $resupdate =  $conn->query($sqlupdate);\r\n-        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"')\";\r\n+        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedlist[$i].\"')\";\r\n         $ress = $conn->query($sqls);\r\n       \r\n     }\r\n     // echo $sql;\r\n"
                },
                {
                    "date": 1633496131527,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,9 +306,9 @@\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n         $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n         $resupdate =  $conn->query($sqlupdate);\r\n-        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedlist[$i].\"')\";\r\n+        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedprice[$i].\"')\";\r\n         $ress = $conn->query($sqls);\r\n       \r\n     }\r\n     // echo $sql;\r\n"
                },
                {
                    "date": 1633496143416,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,10 +7,8 @@\n {\r\n \r\n     $where_like = [\r\n         'notransaction',\r\n-        'name',\r\n-        'noasset',\r\n         'approval'\r\n         \r\n     ];\r\n     \r\n"
                },
                {
                    "date": 1633496148606,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,9 +67,8 @@\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n                 \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n-                \"<label id ='noasset\".$row['id'].\"'>\".$row['noasset'].\"</label>\",\r\n                 \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\"\r\n             \r\n             ];\r\n         }\r\n"
                },
                {
                    "date": 1633496248764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\r\n+    \"SELECT * from transaction_sale where.idsister = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n@@ -66,10 +66,9 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n-                \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\"\r\n+                \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\"\r\n             \r\n             ];\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1633496258924,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,9 +26,9 @@\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n"
                },
                {
                    "date": 1633496265210,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n     \r\n     if(empty($search)) {\r\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses'\");\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses'\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n"
                },
                {
                    "date": 1633496276225,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,20 +30,16 @@\n         $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses'\");\r\n     } else {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR asset.noasset LIKE '%$search%'\r\n-        OR asset.name LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR asset.noasset LIKE '%$search%'\r\n-        OR asset.name LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )\");\r\n     }\r\n     \r\n     $response['data'] = [];\r\n"
                },
                {
                    "date": 1633496281452,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale inner join asset on asset.id =  transaction_sale.idasset where asset.idsistercompany = '$myses' and (\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )\");\r\n     }\r\n"
                },
                {
                    "date": 1633496297911,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -291,9 +291,9 @@\n     $myselectedlist = $_POST['myselected'];\r\n     $myselectedprice = $_POST['myselectedprice'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$mydate', 'TRX-020202', 'pending')\";\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n     $last_id = $conn->insert_id;\r\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n"
                },
                {
                    "date": 1633496329950,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,24 +20,24 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale where.idsister = '$myses'\r\n+    \"SELECT * from transaction_sale where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses'\");\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses'\");\r\n     } else {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' and (\r\n+        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where.idsister = '$myses' and (\r\n+        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )\");\r\n     }\r\n"
                },
                {
                    "date": 1633498996022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -400,9 +400,9 @@\n }\r\n else if($tipe == \"getdetailtransaction\")\r\n {\r\n     $idtransaction = $_POST['idtransaction'];\r\n-    $sql = \"select td.*, asset.name as assetname, asset.noasset  from transaction_dispose_log td inner join asset on asset.id = td.idasset where idtransaksi = '$idtransaction'\";\r\n+    $sql = \"select td.*, asset.name as assetname, asset.noasset  from transaction_sale_log td inner join asset on asset.id = td.idasset where idtransaksi = '$idtransaction'\";\r\n     $res = $conn->query($sql);\r\n     $mystring = \"\";\r\n     $mycountasset = 0;\r\n     $mynumber = 1;\r\n"
                },
                {
                    "date": 1633499031023,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -413,9 +413,9 @@\n         {\r\n             $mycountasset += 1;\r\n             if($mycounter == 1)\r\n             {\r\n-                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div>\";\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].$r['assetname'].\"<br>\".\"</label></div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n                 $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div></div><br>\";\r\n"
                },
                {
                    "date": 1633499042993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -413,9 +413,9 @@\n         {\r\n             $mycountasset += 1;\r\n             if($mycounter == 1)\r\n             {\r\n-                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].$r['assetname'].\"<br>\".\"</label></div>\";\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br>\".$r['assetname']\"</label></div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n                 $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div></div><br>\";\r\n"
                },
                {
                    "date": 1633499061946,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -413,9 +413,9 @@\n         {\r\n             $mycountasset += 1;\r\n             if($mycounter == 1)\r\n             {\r\n-                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br>\".$r['assetname']\"</label></div>\";\r\n+                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n                 $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div></div><br>\";\r\n"
                },
                {
                    "date": 1633499180471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,9 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\"\r\n+                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\"\r\n             \r\n             ];\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1633499219221,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,9 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\"\r\n+                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\"\r\n             \r\n             ];\r\n         }\r\n     }\r\n@@ -417,9 +417,9 @@\n                 $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div>\";\r\n                 $mycounter = 2;\r\n             }\r\n             else{\r\n-                $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"</label></div></div><br>\";\r\n+                $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div></div><br>\";\r\n                 $mycounter = 1;\r\n             }\r\n             $mynumber ++;\r\n             \r\n"
                },
                {
                    "date": 1633669128110,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -411,17 +411,13 @@\n         $mycounter = 1;\r\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n-            if($mycounter == 1)\r\n-            {\r\n-                $mystring .= \"<div class = 'row'><div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div>\";\r\n-                $mycounter = 2;\r\n-            }\r\n-            else{\r\n-                $mystring .= \"<div class = 'col-md-6'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div></div><br>\";\r\n-                $mycounter = 1;\r\n-            }\r\n+          \r\n+                $mystring .= \"<label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label><br><br>\";\r\n+             \r\n+            \r\n+        \r\n             $mynumber ++;\r\n             \r\n         }\r\n         echo $mycountasset.\"||\".$mystring;\r\n"
                },
                {
                    "date": 1633669196205,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,9 +412,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n           \r\n-                $mystring .= \"<label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label><br><br>\";\r\n+                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div>\";\r\n              \r\n             \r\n         \r\n             $mynumber ++;\r\n"
                },
                {
                    "date": 1633669204064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,9 +412,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n           \r\n-                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div>\";\r\n+                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label><br></div>\";\r\n              \r\n             \r\n         \r\n             $mynumber ++;\r\n"
                },
                {
                    "date": 1633669217377,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,9 +412,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n           \r\n-                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label><br></div>\";\r\n+                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div><br>\";\r\n              \r\n             \r\n         \r\n             $mynumber ++;\r\n"
                },
                {
                    "date": 1633669231425,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,9 +412,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n           \r\n-                $mystring .= \"<div class = 'row'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div><br>\";\r\n+                $mystring .= \"<div class = 'row' style = 'margin-left:10px;'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div><br>\";\r\n              \r\n             \r\n         \r\n             $mynumber ++;\r\n"
                },
                {
                    "date": 1633669238574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -412,9 +412,9 @@\n         while($r = mysqli_fetch_array($res))\r\n         {\r\n             $mycountasset += 1;\r\n           \r\n-                $mystring .= \"<div class = 'row' style = 'margin-left:10px;'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div><br>\";\r\n+                $mystring .= \"<div class = 'row' style = 'margin-left:5px;'><label style = 'display:block;float:left;heigth:100px;font-size:12pt;' ><b>$mynumber. </b> &nbsp </label><label style = 'display:block;float:left' >\".$r['assetname'].\"<br>\".$r['noasset'].\"<br> Rp \".$r['harga'].\"</label></div><br>\";\r\n              \r\n             \r\n         \r\n             $mynumber ++;\r\n"
                },
                {
                    "date": 1636374749929,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,23 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\"\r\n+                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\",\r\n+                ' <div class=\"list-icons\">\r\n+                <div class=\"dropdown\">\r\n+                    <a href=\"#\" class=\"list-icons-item\" data-toggle=\"dropdown\">\r\n+                        <i class=\"icon-menu9\"></i>\r\n+                    </a>\r\n+    \r\n+                    <div class=\"dropdown-menu dropdown-menu-right\">\r\n+                        <a href=\"#myModalEditTransactions\"  data-toggle=\"modal\" class=\"dropdown-item\" id =\"click-'.$row['id'].'\"  onclick = \"openmodaledits(this)\"><i class=\"icon-check\"></i>\r\n+                            Edit</a>\r\n+                        \r\n+                   \r\n+                    </div>\r\n+                </div>\r\n+            </div>'\r\n             \r\n             ];\r\n         }\r\n     }\r\n"
                },
                {
                    "date": 1636378867476,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n                         <i class=\"icon-menu9\"></i>\r\n                     </a>\r\n     \r\n                     <div class=\"dropdown-menu dropdown-menu-right\">\r\n-                        <a href=\"#myModalEditTransactions\"  data-toggle=\"modal\" class=\"dropdown-item\" id =\"click-'.$row['id'].'\"  onclick = \"openmodaledits(this)\"><i class=\"icon-check\"></i>\r\n+                        <a href=\"#myModalAddSaleEdit\"  data-toggle=\"modal\" class=\"dropdown-item\" id =\"click-'.$row['id'].'\"  onclick = \"openmodaledits(this)\"><i class=\"icon-check\"></i>\r\n                             Edit</a>\r\n                         \r\n                    \r\n                     </div>\r\n"
                },
                {
                    "date": 1636379138546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,10 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale where idsister = '$myses'\r\n+    \"SELECT * from transaction_sale  inner join transaction_dispose_log tdl on tdl.idtransaksi =  td.id\r\n+    inner join asset on asset.id = tdl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n"
                },
                {
                    "date": 1636379143647,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale  inner join transaction_dispose_log tdl on tdl.idtransaksi =  td.id\r\n+    \"SELECT * from transaction_sale  inner join transaction_sale_log tdl on tdl.idtransaksi =  td.id\r\n     inner join asset on asset.id = tdl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n"
                },
                {
                    "date": 1636379151903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,10 +20,10 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale  inner join transaction_sale_log tdl on tdl.idtransaksi =  td.id\r\n-    inner join asset on asset.id = tdl.idasset  where idsister = '$myses'\r\n+    \"SELECT * from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n     \r\n"
                },
                {
                    "date": 1636379160974,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT * from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n+    \"SELECT tsl.* from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n"
                },
                {
                    "date": 1636379178727,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT tsl.* from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n+    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n"
                },
                {
                    "date": 1636379216561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n+    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n"
                },
                {
                    "date": 1636379222977,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  td.id\r\n+    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n     \"\r\n \r\n );\r\n"
                },
                {
                    "date": 1636379237646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n     \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n-    inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\r\n     \"\r\n \r\n );\r\n     \r\n"
                },
                {
                    "date": 1636379263660,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,18 +27,22 @@\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses'\");\r\n+        $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\");\r\n     } else {\r\n-        $query_data = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' and (\r\n+        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT * from transaction_sale where idsister = '$myses' and (\r\n+        $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n         OR transaction_sale.approval LIKE '%$search%' )\");\r\n     }\r\n"
                },
                {
                    "date": 1636379271992,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,9 +27,10 @@\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts \r\n+         inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\");\r\n"
                },
                {
                    "date": 1636379279447,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,9 +29,9 @@\n     \r\n     if(empty($search)) {\r\n         $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts \r\n          inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n-    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\");\r\n     } else {\r\n"
                },
                {
                    "date": 1636379285449,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,21 +32,21 @@\n          inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n-    inner join asset on asset.id = tsl.idasset  where idsister = '$myses'\");\r\n+    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR transaction_sale.approval LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n+        OR transaction_sale.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n         OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR transaction_sale.approval LIKE '%$search%' )\");\r\n+        OR transaction_sale.approval LIKE '%$search%' ) group by ts.id\");\r\n     }\r\n     \r\n     $response['data'] = [];\r\n     \r\n"
                },
                {
                    "date": 1636379304316,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,11 +36,11 @@\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\");\r\n     } else {\r\n         $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n-            transaction_sale.notransaction LIKE '%$search%' \r\n-        OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR transaction_sale.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n+            ts.notransaction LIKE '%$search%' \r\n+        OR ts.mydate LIKE '%$search%'\r\n+        OR ts.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             transaction_sale.notransaction LIKE '%$search%' \r\n"
                },
                {
                    "date": 1636379341992,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,9 +20,9 @@\n     $search   = $response['search']['value'];\r\n     \r\n     $total_data = mysqli_query($conn, \r\n     \r\n-    \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+    \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\r\n     \"\r\n \r\n );\r\n@@ -42,11 +42,11 @@\n         OR ts.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n-            transaction_sale.notransaction LIKE '%$search%' \r\n-        OR transaction_sale.mydate LIKE '%$search%'\r\n-        OR transaction_sale.approval LIKE '%$search%' ) group by ts.id\");\r\n+            ts.notransaction LIKE '%$search%' \r\n+        OR ts.mydate LIKE '%$search%'\r\n+        OR ts.approval LIKE '%$search%' ) group by ts.id\");\r\n     }\r\n     \r\n     $response['data'] = [];\r\n     \r\n"
                },
                {
                    "date": 1636379368305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,11 +27,10 @@\n \r\n );\r\n     \r\n     if(empty($search)) {\r\n-        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts \r\n-         inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n-    inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id ORDER BY $order $dir LIMIT $start, $length\");\r\n+        $query_data = mysqli_query($conn, \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts \r\n+         inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n         $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\");\r\n     } else {\r\n"
                },
                {
                    "date": 1636379388670,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,12 +30,12 @@\n     if(empty($search)) {\r\n         $query_data = mysqli_query($conn, \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts \r\n          inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+        $total_filtered = mysqli_query($conn, \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' group by ts.id\");\r\n     } else {\r\n-        $query_data = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+        $query_data = mysqli_query($conn, \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             ts.notransaction LIKE '%$search%' \r\n         OR ts.mydate LIKE '%$search%'\r\n         OR ts.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n"
                },
                {
                    "date": 1636379396982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,9 @@\n             ts.notransaction LIKE '%$search%' \r\n         OR ts.mydate LIKE '%$search%'\r\n         OR ts.approval LIKE '%$search%' ) group by ts.id  ORDER BY $order $dir LIMIT $start, $length\");\r\n     \r\n-        $total_filtered = mysqli_query($conn, \"SELECT tsl.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n+        $total_filtered = mysqli_query($conn, \"SELECT ts.*, asset.idgroup, asset.idsubgroup, asset.idcategory  from transaction_sale ts  inner join transaction_sale_log tsl on tsl.idtransaksi =  ts.id\r\n     inner join asset on asset.id = tsl.idasset  where idsister = '$myses' and (\r\n             ts.notransaction LIKE '%$search%' \r\n         OR ts.mydate LIKE '%$search%'\r\n         OR ts.approval LIKE '%$search%' ) group by ts.id\");\r\n"
                },
                {
                    "date": 1636379421868,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,9 +67,12 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\",\r\n+                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\"\r\n+                \"<input type = 'hidden' id = 'category_\".$row['id'].\"' value = '\".$row['idcategory'].\"'>\".\r\n+                \"<input type = 'hidden' id = 'subgroup_\".$row['id'].\"' value = '\".$row['idsubgroup'].\"'>\".\r\n+                \"<input type = 'hidden' id = 'group_\".$row['id'].\"' value = '\".$row['idgroup'].\"'>\".,\r\n                 ' <div class=\"list-icons\">\r\n                 <div class=\"dropdown\">\r\n                     <a href=\"#\" class=\"list-icons-item\" data-toggle=\"dropdown\">\r\n                         <i class=\"icon-menu9\"></i>\r\n"
                },
                {
                    "date": 1636379428752,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,12 +67,12 @@\n             // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n             $response['data'][] = [\r\n                 \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                 \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n-                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\"\r\n+                \"<a href = '#myModalDetailTransaction' id = '\".$row['id'].\"' onclick = openmodaldetailtransaction(this) data-toggle='modal'><label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label></a>\".\r\n                 \"<input type = 'hidden' id = 'category_\".$row['id'].\"' value = '\".$row['idcategory'].\"'>\".\r\n                 \"<input type = 'hidden' id = 'subgroup_\".$row['id'].\"' value = '\".$row['idsubgroup'].\"'>\".\r\n-                \"<input type = 'hidden' id = 'group_\".$row['id'].\"' value = '\".$row['idgroup'].\"'>\".,\r\n+                \"<input type = 'hidden' id = 'group_\".$row['id'].\"' value = '\".$row['idgroup'].\"'>\",\r\n                 ' <div class=\"list-icons\">\r\n                 <div class=\"dropdown\">\r\n                     <a href=\"#\" class=\"list-icons-item\" data-toggle=\"dropdown\">\r\n                         <i class=\"icon-menu9\"></i>\r\n"
                },
                {
                    "date": 1636382238224,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,8 +334,34 @@\n         echo \"tidak\";\r\n     }\r\n     // echo $sql;\r\n }\r\n+else if($tipe == \"add\"){\r\n+    $myselectedlist = $_POST['myselected'];\r\n+    $myselectedprice = $_POST['myselectedprice'];\r\n+    date_default_timezone_set(\"Asia/Bangkok\");\r\n+    $mydate = date(\"Y-m-d\");\r\n+    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n+    $res = $conn->query($sql);\r\n+    $last_id = $conn->insert_id;\r\n+    for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n+    {\r\n+        $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n+        $resupdate =  $conn->query($sqlupdate);\r\n+        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedprice[$i].\"')\";\r\n+        $ress = $conn->query($sqls);\r\n+      \r\n+    }\r\n+    // echo $sql;\r\n+    if(($conn -> affected_rows)>0)\r\n+    {\r\n+        echo \"sukses\";\r\n+    }\r\n+    else{\r\n+        echo \"tidak\";\r\n+    }\r\n+    // echo $sql;\r\n+}\r\n else if($tipe == \"changedata\")\r\n {\r\n     $id  = $_POST['myid'];\r\n     $idsister = $_SESSION['idsister'];\r\n"
                },
                {
                    "date": 1636382274227,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -334,11 +334,12 @@\n         echo \"tidak\";\r\n     }\r\n     // echo $sql;\r\n }\r\n-else if($tipe == \"add\"){\r\n+else if($tipe == \"edit\"){\r\n     $myselectedlist = $_POST['myselected'];\r\n     $myselectedprice = $_POST['myselectedprice'];\r\n+    $myselectedprice = $_POST['myselectedprice'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n"
                },
                {
                    "date": 1636382282030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -337,9 +337,9 @@\n }\r\n else if($tipe == \"edit\"){\r\n     $myselectedlist = $_POST['myselected'];\r\n     $myselectedprice = $_POST['myselectedprice'];\r\n-    $myselectedprice = $_POST['myselectedprice'];\r\n+    $mytransaction = $_POST['mytransaction'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n     $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n"
                },
                {
                    "date": 1636382319702,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n     $myselectedprice = $_POST['myselectedprice'];\r\n     $mytransaction = $_POST['mytransaction'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"INSERT INTO `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n+    $sql = \"delete from `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n     $res = $conn->query($sql);\r\n     $last_id = $conn->insert_id;\r\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n"
                },
                {
                    "date": 1636382344891,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -340,9 +340,9 @@\n     $myselectedprice = $_POST['myselectedprice'];\r\n     $mytransaction = $_POST['mytransaction'];\r\n     date_default_timezone_set(\"Asia/Bangkok\");\r\n     $mydate = date(\"Y-m-d\");\r\n-    $sql = \"delete from `transaction_sale` VALUES (NULL, '$myses', '$mydate', 'TRX-020202', 'pending')\";\r\n+    $sql = \"delete from transaction_sale_log where idtransaksi = '$mytransaction'\";\r\n     $res = $conn->query($sql);\r\n     $last_id = $conn->insert_id;\r\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n"
                },
                {
                    "date": 1636382353811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -345,10 +345,9 @@\n     $res = $conn->query($sql);\r\n     $last_id = $conn->insert_id;\r\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n-        $sqlupdate  = \"UPDATE asset set status_transaction = 'placed' where id = '\".$myselectedlist[$i].\"'\";\r\n-        $resupdate =  $conn->query($sqlupdate);\r\n+      \r\n         $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedprice[$i].\"')\";\r\n         $ress = $conn->query($sqls);\r\n       \r\n     }\r\n"
                },
                {
                    "date": 1636382366343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -346,9 +346,9 @@\n     $last_id = $conn->insert_id;\r\n     for($i = 0 ;  $i < count($myselectedlist) ; $i++)\r\n     {\r\n       \r\n-        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$last_id', '\".$myselectedlist[$i].\"', '\".$myselectedprice[$i].\"')\";\r\n+        $sqls = \"INSERT INTO `transaction_sale_log` VALUES (NULL, '$mytransaction', '\".$myselectedlist[$i].\"', '\".$myselectedprice[$i].\"')\";\r\n         $ress = $conn->query($sqls);\r\n       \r\n     }\r\n     // echo $sql;\r\n"
                }
            ],
            "date": 1633020159770,
            "name": "Commit-0",
            "content": "<?php\r\nrequire '../connection.php';\r\nsession_start();\r\n$myses = $_SESSION['idsister'];\r\n$tipe = $_POST['tipe'];\r\nif($tipe == \"load\")\r\n{\r\n\r\n    $where_like = [\r\n        'notransaction',\r\n        'branch',\r\n        'name',\r\n        'contactname',\r\n        'company',\r\n        'status'\r\n        \r\n    ];\r\n    \r\n    $response = $_REQUEST;\r\n    $start    = $response['start'];\r\n    $length   = $response['length'];\r\n    $order    = $where_like[$response['order'][0]['column']];\r\n    $dir      = $response['order'][0]['dir'];\r\n    $search   = $response['search']['value'];\r\n    \r\n    $total_data = mysqli_query($conn, \r\n    \r\n    \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n    inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n    inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n    inner join asset on asset.id = tltr.idasset\r\n    inner join relation on relation.id  = tltr.relation\r\n    inner join location_room lroom on lroom.id = tltr.room\r\n    where lbranchsetup.idsistercompany = '$myses'\r\n    \"\r\n\r\n);\r\n    \r\n    if(empty($search)) {\r\n        $query_data = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n        inner join asset on asset.id = tltr.idasset\r\n        inner join relation on relation.id  = tltr.relation\r\n        inner join location_room lroom on lroom.id = tltr.room\r\n        where lbranchsetup.idsistercompany = '$myses' ORDER BY $order $dir LIMIT $start, $length\");\r\n    \r\n        $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n        inner join asset on asset.id = tltr.idasset\r\n        inner join relation on relation.id  = tltr.relation\r\n        inner join location_room lroom on lroom.id = tltr.room\r\n        where lbranchsetup.idsistercompany = '$myses'\");\r\n    } else {\r\n        $query_data = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset, asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n        inner join asset on asset.id = tltr.idasset\r\n        inner join relation on relation.id  = tltr.relation\r\n        inner join location_room lroom on lroom.id = tltr.room\r\n        where lbranchsetup.idsistercompany = '$myses' and (\r\n            tltr.notransaction LIKE '%$search%' \r\n        OR lbranch.branch LIKE '%$search%'\r\n        OR asset.noasset LIKE '%$search%'\r\n        OR asset.name LIKE '%$search%'\r\n        OR relation.contactname LIKE '%$search%' \r\n        OR relation.company LIKE '%$search%' \r\n        OR tltr.approval LIKE '%$search%'\r\n        OR tltr.status LIKE '%$search%' )  ORDER BY $order $dir LIMIT $start, $length\");\r\n    \r\n        $total_filtered = mysqli_query($conn, \"SELECT tltr.*, lbranch.branch, asset.noasset,asset.name, relation.company, relation.contactname, lroom.room FROM transaction_lend_to_relation tltr\r\n        inner join location_setup_sister_branch lbranchsetup on lbranchsetup.idbranch = tltr.idbranch\r\n        inner join location_branch lbranch on lbranch.idbranch = lbranchsetup.idbranch \r\n        inner join asset on asset.id = tltr.idasset\r\n        inner join relation on relation.id  = tltr.relation\r\n        inner join location_room lroom on lroom.id = tltr.room\r\n        where lbranchsetup.idsistercompany = '$myses' and (\r\n            tltr.notransaction LIKE '%$search%' \r\n        OR lbranch.branch LIKE '%$search%'\r\n        OR asset.noasset LIKE '%$search%'\r\n        OR asset.name LIKE '%$search%'\r\n        OR relation.contactname LIKE '%$search%' \r\n        OR relation.company LIKE '%$search%' \r\n        OR tltr.approval LIKE '%$search%'\r\n        OR tltr.status LIKE '%$search%' )\");\r\n    }\r\n    \r\n    $response['data'] = [];\r\n    \r\n    if($query_data) {\r\n        while($row = mysqli_fetch_assoc($query_data)) {\r\n            $myapproval = \"\";\r\n            if($row['approval'] == \"pending\")\r\n            {\r\n                $myapproval = \"<span style = 'color:#e37e02'><i class='mi-info'></i> &nbsp Pending </span>\";\r\n            }\r\n            else if($row['approval'] == \"rejected\")\r\n            {\r\n                $myapproval = \"<span style = 'color:#e32702'><i class='mi-cancel'></i> &nbsp Rejected </span>\";\r\n            }\r\n            else if($row['approval'] == \"accepted\")\r\n            {\r\n                $myapproval = \"<span style = 'color:#2aa602'><i class='mi-check-box'></i> &nbspAccepted </span>\";\r\n            }\r\n            // $myrelation = str_replace( \" \", ' ', $row['myrelation'] ); \r\n            $response['data'][] = [\r\n                \"<span class='pointer-element badge badge-success' id ='\".$row['id'].\"' data-id='\".$row['id'].\"'><i class='icon-plus3'></i></span>\",\r\n                \"<b><label id ='statusapproval\".$row['id'].\"'  >\".$myapproval.\"</label></b>\",\r\n                \"<label id ='mydate\".$row['id'].\"'>\".$row['mydate'].\"</label>\",\r\n                \"<label id ='notransaction\".$row['id'].\"'>\".$row['notransaction'].\"</label>\",\r\n                \"<label id ='branch\".$row['id'].\"'>\".$row['branch'].\"</label>\",\r\n                \"<label id ='noasset\".$row['id'].\"'>\".$row['noasset'].\"</label>\",\r\n                \"<label id ='assetname\".$row['id'].\"'>\".$row['name'].\"</label>\",\r\n                \"<label id ='company\".$row['id'].\"'>\".$row['company'].\"</label>\",\r\n                \"<label id ='contactname\".$row['id'].\"'>\".$row['contactname'].\"</label>\",\r\n                \"<label id ='room\".$row['id'].\"'>\".$row['room'].\"</label>\",\r\n                \"<label id ='startdate\".$row['id'].\"'>\".$row['start_date'].\"</label>\",\r\n                \"<label id ='duedate\".$row['id'].\"'>\".$row['due_date'].\"</label>\",\r\n                \"<label id ='status\".$row['id'].\"'>\".$row['status'].\"</label>\"\r\n            ];\r\n        }\r\n    }\r\n    \r\n    $response['recordsTotal'] = 0;\r\n    if($total_data <> FALSE) {\r\n        $response['recordsTotal'] = mysqli_num_rows($total_data);\r\n    }\r\n    \r\n    $response['recordsFiltered'] = 0;\r\n    if($total_filtered <> FALSE) {\r\n        $response['recordsFiltered'] = mysqli_num_rows($total_filtered);\r\n    }  \r\n    \r\n    echo json_encode($response);\r\n}\r\nelse if($tipe == \"getassetdesc\")\r\n{\r\n    $assetid = $_POST['assetid'];\r\n    $sql = \"select asset.id, asset.noasset, asset.name, c.name as conditions, ic.initial_condition from asset\r\n     inner join conditions c on c.id = asset.idcondition \r\n    inner join initial_condition ic on ic.id = asset.idinitialcondition where asset.id = '$assetid'\";\r\n    $res = $conn->query($sql);\r\n    $row = mysqli_fetch_array($res);\r\n    \r\n    $mystring = $row['noasset'].\"~~\".$row['name'].\"~~\".$row['conditions'].\"~~\".$row['initial_condition'];\r\n    echo $mystring;\r\n}\r\nelse if($tipe == \"getassetlist\")\r\n{\r\n    $idgroup = $_POST['idgroup'];\r\n    $sql = \"select asset.id, asset.noasset, asset.name from asset where asset.idgroup = '$idgroup' and asset.idsistercompany = '$myses'\";\r\n    $res = $conn->query($sql);\r\n    // $row = mysqli_fetch_array($res);\r\n    $mystring = \"\";\r\n    if($res -> num_rows>0)\r\n    {\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['noasset'].\"-\".$r['name'].\"</option>\";\r\n        }\r\n    }\r\n    echo $mystring;\r\n}\r\nelse if($tipe == \"getdetailuser\")\r\n{\r\n    $iduser = $_POST['iduser'];\r\n    $sql = \"select karyawan.*, rank.rank from karyawan inner join rank on rank.id = karyawan.idrank where nik = '$iduser' \";\r\n    $res = $conn->query($sql);\r\n    $row = mysqli_fetch_array($res);\r\n    $mystring = $row['nik'].\"~~\".$row['nama'].\"~~\".$row['email'].\"~~\".$row['rank'];\r\n    echo $mystring;\r\n}\r\nelse if($tipe == \"getuser\")\r\n{\r\n    $idbranch = $_POST['idbranch'];\r\n    $iddepartment = $_POST['iddepartment'];\r\n    $sql = \"select * from karyawan where idbranch = '$idbranch' and iddepartment = '$iddepartment'\";\r\n    $res = $conn->query($sql);\r\n    $mystring = \"\";\r\n    if($res -> num_rows>0)\r\n    {\r\n        $myuser = \"\";\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n          \r\n            $mystring .= \"<option value = '\".$r['nik'].\"'> \".$r['nik'].\"-\".$r['nama'].\"</option>\";\r\n        }\r\n        echo $mystring;\r\n    }\r\n    else\r\n    {\r\n        echo \"none\";\r\n    }\r\n \r\n\r\n}\r\nelse if($tipe == \"gettemplatecategory\")\r\n{\r\n    $idcategory = $_POST['idcategory'];\r\n    $sql = \"select template.id, template.template from kategori_categorysubgroup kcs inner join template on template.id = kcs.idtemplate where kcs.id = '$idcategory'\";\r\n    $res = $conn->query($sql);\r\n    $row = mysqli_fetch_array($res);\r\n    \r\n    if($res->num_rows>0)\r\n    {\r\n        $idtemplate = $row['id'];\r\n        $nametemplate = $row['template'];\r\n        echo $idtemplate.\"~~~\";\r\n        echo $nametemplate.\"~~~\";\r\n        $sqls = \"select folder_custom.*, custom_to_template.id as idquestion  from custom_to_template inner join folder_custom on folder_custom.id = custom_to_template.idcustom where custom_to_template.idtemplate = '$idtemplate'\"; \r\n        $ress = $conn->query($sqls);\r\n        // echo $sqls;\r\n        if($ress -> num_rows>0)\r\n        {\r\n            $mystring = \"\";\r\n            $mycode = \"\";\r\n            $myindex = 0 ;\r\n            while($r = mysqli_fetch_array($ress))\r\n            {\r\n                if($myindex == 0)\r\n                {\r\n                    $mycode .= $r['id'];\r\n                }\r\n                else{\r\n                    $mycode .= \",\".$r['id'];\r\n                }\r\n                $myindex++;\r\n               \r\n                $mystring .=  '\r\n                <div class=\"row\">\r\n                  <div class=\"col-md-12\">\r\n                        <div class=\"form-group\">\r\n                            <label>'.$r['name'].' </label>\r\n                            <input type=\"text\" name=\"custom'.$r['idquestion'].'\" placeholder=\"Enter '.$r['name'].'\" class=\"form-control required\" id = \"startwarranty\"><br>\r\n                        </div>\r\n                    </div>\r\n                </div>';\r\n            }\r\n            echo $mycode.\"~~\".$mystring;\r\n        }\r\n        else{\r\n            echo \"none\";\r\n        }\r\n    }\r\n    else{\r\n        echo \"another\";\r\n    }\r\n\r\n}\r\nelse if($tipe == \"getallanswer\")\r\n{\r\n\r\n    $idasset = $_POST['idassets'];\r\n    $sql = \"select folder_custom.name as namequestion, custom_template_answer.answer from custom_template_answer \r\n    inner join custom_to_template on custom_to_template.id = custom_template_answer.id_custom_to_template\r\n    inner join folder_custom on folder_custom.id = custom_to_template.idcustom\r\n    where custom_template_answer.idasset = '$idasset'\";\r\n  \r\n    $res = $conn->query($sql);\r\n    if($res -> num_rows>0)\r\n    {\r\n        // echo $sql;\r\n        $mystring = \"\";\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n        \r\n            $mystring .=  '\r\n            <div class=\"row\">\r\n              <div class=\"col-md-12\">\r\n                    <div class=\"form-group\">\r\n                        <label>'.$r['namequestion'].' </label><br>\r\n                        <b><label>'.$r['answer'].'</label></b>\r\n                    </div>\r\n                </div>\r\n            </div>';\r\n        }\r\n        echo $mystring;\r\n    }\r\n    else{\r\n        echo \"none\";\r\n    }\r\n}\r\nelse if($tipe == \"getcustomquestion\")\r\n{\r\n    $idtemplate = $_POST['idtemplate'];\r\n    $sql = \"select folder_custom.*, custom_to_template.id as idquestion  from custom_to_template inner join folder_custom on folder_custom.id = custom_to_template.idcustom where custom_to_template.idtemplate = '$idtemplate'\"; \r\n    $res = $conn->query($sql);\r\n    if($res -> num_rows>0)\r\n    {\r\n        $mystring = \"\";\r\n        $mycode = \"\";\r\n        $myindex = 0 ;\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n            if($myindex == 0)\r\n            {\r\n                $mycode .= $r['id'];\r\n            }\r\n            else{\r\n                $mycode .= \",\".$r['id'];\r\n            }\r\n            $myindex++;\r\n           \r\n            $mystring .=  '\r\n            <div class=\"row\">\r\n              <div class=\"col-md-12\">\r\n                    <div class=\"form-group\">\r\n                        <label>'.$r['name'].' </label>\r\n                        <input type=\"text\" name=\"custom'.$r['idquestion'].'\" placeholder=\"Enter '.$r['name'].'\" class=\"form-control required\" id = \"startwarranty\"><br>\r\n                    </div>\r\n                </div>\r\n            </div>';\r\n        }\r\n        echo $mycode.\"~~\".$mystring;\r\n    }\r\n    else{\r\n        echo \"none\";\r\n    }\r\n\r\n}\r\nelse if($tipe == \"getroom\")\r\n{\r\n    $idbranch = $_POST['idbranch'];\r\n    $sql = \"SELECT lroom.* FROM location_room lroom \r\n    inner join location_setup_building_floor lsbf on lsbf.idlocationsetupbuildingfloor = lroom.idsetupbuildingfloor\r\n    inner join location_building lbuilding on lbuilding.id = lsbf.idbuilding\r\n    inner join location_setup_sister_branch lssb on lssb.idsetupsisterbranch = lbuilding.idsetupsisterbranch\r\n    inner join location_branch lbranch on lbranch.idbranch = lssb.idbranch\r\n    where lbranch.idbranch = '$idbranch'\";\r\n    $res = $conn->query($sql);\r\n    $mystring = \"\";\r\n    if($res -> num_rows>0)\r\n    {\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['room'].\"</option>\";\r\n        }\r\n    }\r\n    echo $mystring;\r\n}\r\n\r\nelse if($tipe == \"add\"){\r\n\r\n    $myrelation = $_POST['myrelation'];\r\n    $mygroup = $_POST['mygroup'];\r\n    $myasset = $_POST['myasset'];\r\n    $mybranch = $_POST['mybranch'];\r\n    $myroom = $_POST['myroom'];\r\n    $mystart = $_POST['mystart'];\r\n    $myend = $_POST['myend'];\r\n    date_default_timezone_set(\"Asia/Bangkok\");\r\n    $datestart=date_create($mystart);\r\n    $dateend=date_create($myend);\r\n    $convertstart = date_format($datestart,\"Y-m-d\");\r\n    $convertend = date_format($dateend,\"Y-m-d\");\r\n    $mydate = date(\"Y-m-d\");\r\n    $sql = \"INSERT INTO `transaction_lend_to_relation`\r\n    VALUES (NULL, 'TRX-020', '$mybranch', '$myasset', '$myrelation', '$myroom', '$convertstart', '$convertend', 'pending', 'waiting', '$mydate');\";\r\n    $res = $conn->query($sql);\r\n    // echo $sql;\r\n    if(($conn -> affected_rows)>0)\r\n    {\r\n        echo \"sukses\";\r\n    }\r\n    else{\r\n        echo \"tidak\";\r\n    }\r\n    // echo $sql;\r\n}\r\nelse if($tipe == \"changedata\")\r\n{\r\n    $id  = $_POST['myid'];\r\n    $idsister = $_SESSION['idsister'];\r\n    $group = $_POST['group'];\r\n    $subgroup = $_POST['subgroup'];\r\n    $category = $_POST['category'];\r\n    $initialcondition = $_POST['initialcondition'];\r\n    $condition = $_POST['condition'];\r\n    $noasset = $_POST['noasset'];\r\n    $name = $_POST['name'];\r\n    $sql = \"update asset set \r\n           idsistercompany = '\".$idsister.\"', \r\n           idgroup = '\".$group.\"', \r\n           idsubgroup = '\".$subgroup.\"',\r\n           idcategory = '\".$category.\"',\r\n           idinitialcondition = '\".$initialcondition.\"',\r\n           idcondition = '\".$condition.\"',\r\n           noasset = '\".$noasset.\"',\r\n           name = '\".$name.\"' \r\n            where id = '\".$id.\"'\";\r\n    $res = $conn->query($sql);\r\n    if(($conn -> affected_rows)>0)\r\n    {\r\n        echo \"sukses\";\r\n    }\r\n    else{\r\n        echo \"tidak\";\r\n    }\r\n}\r\nelse if($tipe == \"setstatus\")\r\n{\r\n    $myid = $_POST['myidchange'];\r\n    $stat = $_POST['stat'];\r\n    $sql = \"update asset set status = '\".$stat.\"' where id = '\".$myid.\"'\";\r\n    $res = $conn->query($sql);\r\n}\r\nelse if($tipe == \"getassetdesc\")\r\n{\r\n    $assetid = $_POST['assetid'];\r\n    $sql = \"select asset.id, asset.noasset, asset.name, c.name as conditions, ic.initial_condition from asset\r\n     inner join conditions c on c.id = asset.idcondition \r\n    inner join initial_condition ic on ic.id = asset.idinitialcondition where asset.id = '$assetid'\";\r\n    $res = $conn->query($sql);\r\n    $row = mysqli_fetch_array($res);\r\n    \r\n    $mystring = $row['noasset'].\"~~\".$row['name'].\"~~\".$row['conditions'].\"~~\".$row['initial_condition'];\r\n    echo $mystring;\r\n}\r\nelse if($tipe == \"getassetlist\")\r\n{\r\n    $idgroup = $_POST['idgroup'];\r\n    $sql = \"select asset.id, asset.noasset, asset.name from asset where asset.idgroup = '$idgroup' and asset.idsistercompany = '$myses'\";\r\n    $res = $conn->query($sql);\r\n    // $row = mysqli_fetch_array($res);\r\n    $mystring = \"\";\r\n    if($res -> num_rows>0)\r\n    {\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['noasset'].\"-\".$r['name'].\"</option>\";\r\n        }\r\n    }\r\n    echo $mystring;\r\n}\r\nelse if($tipe == \"getroom\")\r\n{\r\n    $idbranch = $_POST['idbranch'];\r\n    $sql = \"SELECT lroom.* FROM location_room lroom \r\n    inner join location_setup_building_floor lsbf on lsbf.idlocationsetupbuildingfloor = lroom.idsetupbuildingfloor\r\n    inner join location_building lbuilding on lbuilding.id = lsbf.idbuilding\r\n    inner join location_setup_sister_branch lssb on lssb.idsetupsisterbranch = lbuilding.idsetupsisterbranch\r\n    inner join location_branch lbranch on lbranch.idbranch = lssb.idbranch\r\n    where lbranch.idbranch = '$idbranch'\";\r\n    $res = $conn->query($sql);\r\n    $mystring = \"\";\r\n    if($res -> num_rows>0)\r\n    {\r\n        while($r = mysqli_fetch_array($res))\r\n        {\r\n            $mystring .= \"<option value = '\".$r['id'].\"'> \".$r['room'].\"</option>\";\r\n        }\r\n    }\r\n    echo $mystring;\r\n}\r\n?>\r\n"
        }
    ]
}